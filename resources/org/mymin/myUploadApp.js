window.myUploadApp={typeConfig:{img:{title:'Images',extensions:'gif,jpg,jpeg,bmp,png',mimeTypes:'image/*'},audio:{title:'audio',extensions:'mp3,ogg',mimeTypes:'audio/*'},video:{title:'video',extensions:'mp4,AVI,RM,wmv,asf,mov,flv',mimeTypes:'video/*'}},serverConfig:{img:'/admin/fileUpload/img',audio:'/admin/fileUpload/audio',video:'/admin/fileUpload/video'},objConfig:{img:new Image,audio:new Audio,video:document.createElement('VIDEO')},img:'',uploadBase:function(a,b,c){var e=this,f=this.serverConfig[b],g=this.objConfig[b],h=WebUploader.create({auto:!0,swf:'/resources/org/uploadLibs/webuploader/Uploader.swf',server:f,pick:{id:'#picker-'+a,multiple:!1,innerHTML:c},accept:this.typeConfig[b]});h.on('fileQueued',function(){}),h.on('uploadProgress',function(i,j){console.log(i),$('#picker-'+a).css({display:'none'}),$('#'+a+' .progress').css({display:'block'}),$('#'+a+' .progress .progress-bar').css({width:100*j+'%'})}),h.on('uploadSuccess',function(){}),h.on('uploadAccept',function(i,j){if($('.inputMap-'+a).val('uploads/'+j.filename),$('.show-'+a).html('<img src="/uploads/'+j.filename+'" width="200" class="thumbnail_'+a+'">'),'img'==b);else if('audio'==b){g.setAttribute('controls','controls'),g.style.float='left';$('.show-'+a).append('<span class=\'btn btn-danger btn-sm thumbnail_'+a+'\' style=\'float:right\'>\u79FB\u9664</span>')}else g.setAttribute('class','thumbnail thumbnail_'+a),g.setAttribute('controls','controls'),g.setAttribute('width',400);$('.thumbnail_'+a).on('click',function(){e.del(a,b,c)})}),h.on('uploadError',function(){alert('\u4E0A\u4F20\u5931\u8D25'),$('#imgPicker-'+a).css({display:'block'})}),h.on('uploadComplete',function(){$('#'+a+' .progress').css({display:'none'})})},del:function(a,b,c){var d=this,e='img'==b?'\u56FE\u7247':'audio'==b?'\u97F3\u4E50':'\u89C6\u9891';layer.confirm('\u4F60\u786E\u8BA4\u5220\u9664'+e+'\u4E48\uFF1F',{offset:'100px',btn:['\u786E\u8BA4','\u53D6\u6D88']},function(f){layer.close(f),$('.inputMap-'+a).val(''),$('.show-'+a).empty(),$('#picker-'+a).css({display:'block'}).empty(),d.uploadBase(a,b,c)},function(){layer.close()})}};